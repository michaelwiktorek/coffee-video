(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var ImageEditor, animation_id, b, canvas, chroma, chroma_key, ctx, editor, g, gradient, gradient_snapshot, playing, r, set_b, set_g, set_r, set_threshold, sobel_filter, start, start_canvas, start_chroma, start_gradient, stop, stop_canvas, stop_chroma, stop_gradient, threshold, update, video;

canvas = null;

ctx = null;

video = null;

animation_id = null;

playing = false;

gradient = false;

chroma = false;

threshold = 0;

r = 0;

g = 0;

b = 0;

ImageEditor = require("./image_editor.coffee");

editor = new ImageEditor(42);

window.onload = function() {
  canvas = document.querySelector('canvas');
  ctx = canvas.getContext('2d');
  document.querySelector('#start_button').onclick = start;
  document.querySelector('#stop_button').onclick = stop;
  document.querySelector('#start_canvas_button').onclick = start_gradient;
  document.querySelector('#stop_canvas_button').onclick = stop_gradient;
  document.querySelector('#sobel_snapshot').onclick = gradient_snapshot;
  document.querySelector('#grad_slider').oninput = set_threshold;
  document.querySelector('#start_direct').onclick = start_canvas;
  document.querySelector('#stop_direct').onclick = stop_canvas;
  document.querySelector('#start_chroma').onclick = start_chroma;
  document.querySelector('#stop_chroma').onclick = stop_chroma;
  document.querySelector('#rslider').oninput = set_r;
  document.querySelector('#gslider').oninput = set_g;
  return document.querySelector('#bslider').oninput = set_b;
};

start = function() {
  navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia;
  video = document.querySelector('video');
  return navigator.getUserMedia({
    video: true,
    audio: false
  }, function(stream) {
    return video.src = window.URL.createObjectURL(stream);
  }, function() {
    return alert("error");
  });
};

stop = function() {
  return video.src = '';
};

update = function() {
  ctx.drawImage(video, 0, 0);
  if (gradient) {
    sobel_filter();
  } else if (chroma) {
    chroma_key();
  }
  return animation_id = window.requestAnimationFrame(update);
};

start_gradient = function() {
  if (!chroma) {
    return gradient = true;
  }
};

stop_gradient = function() {
  if (!chroma) {
    return gradient = false;
  }
};

sobel_filter = function() {
  return editor.sobel_filter(ctx, threshold);
};

gradient_snapshot = function() {
  ctx.drawImage(video, 0, 0);
  sobel_filter();
  playing = false;
  gradient = false;
  chroma = false;
  return window.cancelAnimationFrame(animation_id);
};

set_threshold = function() {
  var slider;
  slider = document.querySelector('#grad_slider');
  return threshold = slider.value;
};

start_chroma = function() {
  if (!gradient) {
    return chroma = true;
  }
};

stop_chroma = function() {
  if (!gradient) {
    return chroma = false;
  }
};

chroma_key = function() {
  return editor.chroma_key(ctx, r, g, b);
};

start_canvas = function() {
  playing = true;
  return animation_id = window.requestAnimationFrame(update);
};

stop_canvas = function() {
  playing = false;
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  return window.cancelAnimationFrame(animation_id);
};

set_r = function() {
  var slider;
  slider = document.querySelector('#rslider');
  return r = slider.value;
};

set_g = function() {
  var slider;
  slider = document.querySelector('#gslider');
  return g = slider.value;
};

set_b = function() {
  var slider;
  slider = document.querySelector('#bslider');
  return b = slider.value;
};



},{"./image_editor.coffee":2}],2:[function(require,module,exports){
var ImageEditor, Util, util;

Util = require("./util.coffee");

util = new Util();

ImageEditor = (function() {
  ImageEditor.prototype.sobel_x = [-1, 0, 1, -2, 0, 2, -1, 0, 1];

  ImageEditor.prototype.sobel_y = [-1, -2, -1, 0, 0, 0, 1, 2, 1];

  function ImageEditor(number) {
    this.number = number;
  }

  ImageEditor.prototype.sobel_single = function(subimage) {
    var a, b;
    a = util.matrix_magnitude(util.convolve(this.sobel_x, subimage));
    b = util.matrix_magnitude(util.convolve(this.sobel_y, subimage));
    return a + b;
  };

  ImageEditor.prototype.fast_sobel = function(m) {
    var a, b;
    a = Math.abs(m[0] + 2 * m[1] + m[2]) - (m[6] + 2 * m[7] + m[8]);
    b = Math.abs(m[2] + 2 * m[5] + m[8]) - (m[0] + 2 * m[3] + m[6]);
    return a + b;
  };

  ImageEditor.prototype.sobel_filter = function(ctx, thresh) {
    var a, b, g, height, i, image, index, j, k, l, n, new_image, o, r, ref, subimage, value, width;
    image = ctx.getImageData(0, 0, ctx.canvas.width, ctx.canvas.height);
    subimage = [9];
    width = image.width;
    height = image.height;
    new_image = ctx.createImageData(width, height);
    for (i = l = 0, ref = width * height - 1; 0 <= ref ? l <= ref : l >= ref; i = 0 <= ref ? ++l : --l) {
      for (j = n = -1; n <= 1; j = ++n) {
        for (k = o = -1; o <= 1; k = ++o) {
          index = 4 * (i + (j * width) + k);
          r = image.data[index];
          g = image.data[index + 1];
          b = image.data[index + 2];
          a = image.data[index + 3];
          subimage[(j + 1) * 3 + (k + 1)] = this.luminance(r, g, b, a);
        }
      }
      value = 1.5 * this.sobel_single(subimage);
      if (value < thresh) {
        value = 0;
      }
      new_image.data[index] = value;
      new_image.data[index + 1] = value;
      new_image.data[index + 2] = value;
      new_image.data[index + 3] = 255;
    }
    return ctx.putImageData(new_image, 0, 0);
  };

  ImageEditor.prototype.luminance = function(r, g, b, a) {
    return 0.2126 * r + 0.7152 * g + 0.0722 * b;
  };

  ImageEditor.prototype.chroma_key = function(ctx, r, g, b) {
    var a, blue, green, i, image, l, len, red, ref;
    image = ctx.getImageData(0, 0, ctx.canvas.width, ctx.canvas.height);
    len = image.data.length / 4;
    for (i = l = 0, ref = len - 1; 0 <= ref ? l <= ref : l >= ref; i = 0 <= ref ? ++l : --l) {
      red = image.data[4 * i];
      green = image.data[4 * i + 1];
      blue = image.data[4 * i + 2];
      a = image.data[4 * i + 3];
      if ((red < r) && (green < g) && (blue < b)) {
        image.data[4 * i + 3] = 0;
      }
    }
    return ctx.putImageData(image, 0, 0);
  };

  return ImageEditor;

})();

module.exports = ImageEditor;



},{"./util.coffee":3}],3:[function(require,module,exports){
var Util;

Util = (function() {
  function Util() {}

  Util.prototype.convolve = function(a, b) {
    var i, j, output;
    output = [9];
    for (i = j = 0; j <= 8; i = ++j) {
      output[i] = a[i] * b[i];
    }
    return output;
  };

  Util.prototype.matrix_sum = function(a, b) {
    var i, j, output;
    output = [9];
    for (i = j = 0; j <= 8; i = ++j) {
      output[i] = a[i] + b[i];
    }
    return output;
  };

  Util.prototype.matrix_magnitude = function(matrix) {
    var i, j, output;
    output = 0;
    for (i = j = 0; j <= 8; i = ++j) {
      output = output + matrix[i];
    }
    return output;
  };

  return Util;

})();

module.exports = Util;



},{}]},{},[1])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIvVXNlcnMvbWljaGFlbHdpa3RvcmVrL1NpdGVzL2h0bWwtdmlkZW8vc3JjL3Rlc3QuY29mZmVlIiwiL1VzZXJzL21pY2hhZWx3aWt0b3Jlay9TaXRlcy9odG1sLXZpZGVvL3NyYy9pbWFnZV9lZGl0b3IuY29mZmVlIiwiL1VzZXJzL21pY2hhZWx3aWt0b3Jlay9TaXRlcy9odG1sLXZpZGVvL3NyYy91dGlsLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBLElBQUEsK1JBQUE7O0FBQUEsTUFBQSxHQUFTLElBQVQsQ0FBQTs7QUFBQSxHQUNBLEdBQU0sSUFETixDQUFBOztBQUFBLEtBRUEsR0FBUSxJQUZSLENBQUE7O0FBQUEsWUFHQSxHQUFlLElBSGYsQ0FBQTs7QUFBQSxPQUlBLEdBQVUsS0FKVixDQUFBOztBQUFBLFFBS0EsR0FBVyxLQUxYLENBQUE7O0FBQUEsTUFNQSxHQUFTLEtBTlQsQ0FBQTs7QUFBQSxTQU9BLEdBQVksQ0FQWixDQUFBOztBQUFBLENBUUEsR0FBSSxDQVJKLENBQUE7O0FBQUEsQ0FTQSxHQUFJLENBVEosQ0FBQTs7QUFBQSxDQVVBLEdBQUksQ0FWSixDQUFBOztBQUFBLFdBWUEsR0FBYyxPQUFBLENBQVEsdUJBQVIsQ0FaZCxDQUFBOztBQUFBLE1BYUEsR0FBYSxJQUFBLFdBQUEsQ0FBWSxFQUFaLENBYmIsQ0FBQTs7QUFBQSxNQWVNLENBQUMsTUFBUCxHQUFnQixTQUFBLEdBQUE7QUFDZCxFQUFBLE1BQUEsR0FBUyxRQUFRLENBQUMsYUFBVCxDQUF1QixRQUF2QixDQUFULENBQUE7QUFBQSxFQUNBLEdBQUEsR0FBTSxNQUFNLENBQUMsVUFBUCxDQUFrQixJQUFsQixDQUROLENBQUE7QUFBQSxFQUVBLFFBQVEsQ0FBQyxhQUFULENBQXVCLGVBQXZCLENBQXVDLENBQUMsT0FBeEMsR0FBa0Qs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IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJjYW52YXMgPSBudWxsXG5jdHggPSBudWxsXG52aWRlbyA9IG51bGxcbmFuaW1hdGlvbl9pZCA9IG51bGxcbnBsYXlpbmcgPSBmYWxzZVxuZ3JhZGllbnQgPSBmYWxzZVxuY2hyb21hID0gZmFsc2VcbnRocmVzaG9sZCA9IDBcbnIgPSAwXG5nID0gMFxuYiA9IDBcblxuSW1hZ2VFZGl0b3IgPSByZXF1aXJlIFwiLi9pbWFnZV9lZGl0b3IuY29mZmVlXCJcbmVkaXRvciA9IG5ldyBJbWFnZUVkaXRvcig0Milcblxud2luZG93Lm9ubG9hZCA9IC0+XG4gIGNhbnZhcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2NhbnZhcycpXG4gIGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzdGFydF9idXR0b24nKS5vbmNsaWNrID0gc3RhcnRcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3N0b3BfYnV0dG9uJykub25jbGljayA9IHN0b3BcblxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc3RhcnRfY2FudmFzX2J1dHRvbicpLm9uY2xpY2sgPSBzdGFydF9ncmFkaWVudFxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc3RvcF9jYW52YXNfYnV0dG9uJykub25jbGljayA9IHN0b3BfZ3JhZGllbnRcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3NvYmVsX3NuYXBzaG90Jykub25jbGljayA9IGdyYWRpZW50X3NuYXBzaG90XG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNncmFkX3NsaWRlcicpLm9uaW5wdXQgPSBzZXRfdGhyZXNob2xkXG5cbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3N0YXJ0X2RpcmVjdCcpLm9uY2xpY2sgPSBzdGFydF9jYW52YXNcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3N0b3BfZGlyZWN0Jykub25jbGljayA9IHN0b3BfY2FudmFzXG5cbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3N0YXJ0X2Nocm9tYScpLm9uY2xpY2sgPSBzdGFydF9jaHJvbWFcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3N0b3BfY2hyb21hJykub25jbGljayA9IHN0b3BfY2hyb21hXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNyc2xpZGVyJykub25pbnB1dCA9IHNldF9yXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNnc2xpZGVyJykub25pbnB1dCA9IHNldF9nXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNic2xpZGVyJykub25pbnB1dCA9IHNldF9iXG5cblxuc3RhcnQgPSAtPlxuICBuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhID0gbmF2aWdhdG9yLmdldFVzZXJNZWRpYSBvciBuYXZpZ2F0b3Iud2Via2l0R2V0VXNlck1lZGlhXG4gIHZpZGVvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigndmlkZW8nKVxuICBuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhKHt2aWRlbzogdHJ1ZSwgYXVkaW86IGZhbHNlfSwgXG4gICAgKHN0cmVhbSktPlxuICAgICAgdmlkZW8uc3JjID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoc3RyZWFtKVxuICAgICwgLT5cbiAgICAgIGFsZXJ0IFwiZXJyb3JcIilcblxuc3RvcCA9IC0+XG4gIHZpZGVvLnNyYyA9ICcnXG5cbnVwZGF0ZSA9IC0+XG4gIGN0eC5kcmF3SW1hZ2UodmlkZW8sIDAsIDApXG4gIGlmIGdyYWRpZW50XG4gICAgc29iZWxfZmlsdGVyKClcbiAgZWxzZSBpZiBjaHJvbWFcbiAgICBjaHJvbWFfa2V5KClcbiAgYW5pbWF0aW9uX2lkID0gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSh1cGRhdGUpXG5cbnN0YXJ0X2dyYWRpZW50ID0gLT5cbiAgaWYgbm90IGNocm9tYVxuICAgIGdyYWRpZW50ID0gdHJ1ZVxuXG5zdG9wX2dyYWRpZW50ID0gLT5cbiAgaWYgbm90IGNocm9tYVxuICAgIGdyYWRpZW50ID0gZmFsc2Vcblxuc29iZWxfZmlsdGVyID0gLT5cbiAgZWRpdG9yLnNvYmVsX2ZpbHRlcihjdHgsIHRocmVzaG9sZClcblxuZ3JhZGllbnRfc25hcHNob3QgPSAtPlxuICBjdHguZHJhd0ltYWdlKHZpZGVvLCAwLCAwKVxuICBzb2JlbF9maWx0ZXIoKVxuICBwbGF5aW5nID0gZmFsc2VcbiAgZ3JhZGllbnQgPSBmYWxzZVxuICBjaHJvbWEgPSBmYWxzZVxuICB3aW5kb3cuY2FuY2VsQW5pbWF0aW9uRnJhbWUoYW5pbWF0aW9uX2lkKVxuXG5zZXRfdGhyZXNob2xkID0gLT5cbiAgc2xpZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2dyYWRfc2xpZGVyJylcbiAgdGhyZXNob2xkID0gc2xpZGVyLnZhbHVlXG5cbnN0YXJ0X2Nocm9tYSA9IC0+XG4gIGlmIG5vdCBncmFkaWVudFxuICAgIGNocm9tYSA9IHRydWVcblxuc3RvcF9jaHJvbWEgPSAtPlxuICBpZiBub3QgZ3JhZGllbnRcbiAgICBjaHJvbWEgPSBmYWxzZVxuXG5jaHJvbWFfa2V5ID0gLT5cbiAgZWRpdG9yLmNocm9tYV9rZXkoY3R4LCByLCBnLCBiKVxuXG5zdGFydF9jYW52YXMgPSAtPlxuICBwbGF5aW5nID0gdHJ1ZVxuICBhbmltYXRpb25faWQgPSB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKHVwZGF0ZSlcblxuc3RvcF9jYW52YXMgPSAtPlxuICBwbGF5aW5nID0gZmFsc2VcbiAgY3R4LmNsZWFyUmVjdCgwLDAsY2FudmFzLndpZHRoLGNhbnZhcy5oZWlnaHQpXG4gIHdpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZShhbmltYXRpb25faWQpXG5cbnNldF9yID0gLT5cbiAgc2xpZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3JzbGlkZXInKVxuICByID0gc2xpZGVyLnZhbHVlXG5zZXRfZyA9IC0+XG4gIHNsaWRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNnc2xpZGVyJylcbiAgZyA9IHNsaWRlci52YWx1ZVxuc2V0X2IgPSAtPlxuICBzbGlkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYnNsaWRlcicpXG4gIGIgPSBzbGlkZXIudmFsdWUiLCJVdGlsID0gcmVxdWlyZSBcIi4vdXRpbC5jb2ZmZWVcIlxuXG51dGlsID0gbmV3IFV0aWwoKVxuXG5jbGFzcyBJbWFnZUVkaXRvclxuXG4gIHNvYmVsX3g6IFsgLTEsIDAsIDEsXG4gICAgICAgICAgICAgICAtMiwgMCwgMixcbiAgICAgICAgICAgICAgIC0xLCAwLCAxIF1cblxuICBzb2JlbF95OiBbIC0xLCAtMiwgLTEsXG4gICAgICAgICAgICAgICAgMCwgIDAsICAwLFxuICAgICAgICAgICAgICAgIDEsICAyLCAgMSBdXG5cbiAgY29uc3RydWN0b3I6IChudW1iZXIpIC0+XG4gICAgQG51bWJlciA9IG51bWJlclxuXG4gIHNvYmVsX3NpbmdsZTogKHN1YmltYWdlKSAtPlxuICAgICMgcmV0dXJuIHV0aWwubWF0cml4X21hZ25pdHVkZShcbiAgICAjICAgdXRpbC5tYXRyaXhfc3VtKFxuICAgICMgICAgIHV0aWwuY29udm9sdmUoQHNvYmVsX3gsIHN1YmltYWdlKSwgXG4gICAgIyAgICAgdXRpbC5jb252b2x2ZShAc29iZWxfeSwgc3ViaW1hZ2UpXG4gICAgIyAgICAgKVxuICAgICMgICApXG4gICAgYSA9IHV0aWwubWF0cml4X21hZ25pdHVkZSh1dGlsLmNvbnZvbHZlKEBzb2JlbF94LCBzdWJpbWFnZSkpXG4gICAgYiA9IHV0aWwubWF0cml4X21hZ25pdHVkZSh1dGlsLmNvbnZvbHZlKEBzb2JlbF95LCBzdWJpbWFnZSkpXG4gICAgcmV0dXJuIGEgKyBiXG5cbiAgZmFzdF9zb2JlbDogKG0pIC0+XG4gICAgYSA9IE1hdGguYWJzKG1bMF0gKyAyICogbVsxXSArIG1bMl0pIC0gKG1bNl0gKyAyICogbVs3XSArIG1bOF0pXG4gICAgYiA9IE1hdGguYWJzKG1bMl0gKyAyICogbVs1XSArIG1bOF0pIC0gKG1bMF0gKyAyICogbVszXSArIG1bNl0pXG4gICAgcmV0dXJuIGEgKyBiXG5cbiAgIyBhcHBseSBzb2JlbF9zaW5nbGUgdG8gZXZlcnkgM3gzIG1hdHJpeFxuICAjIG9mIHBpeGVscyBpbiB0aGUgaW1hZ2VcbiAgc29iZWxfZmlsdGVyOiAoY3R4LCB0aHJlc2gpIC0+XG4gICAgaW1hZ2UgPSBjdHguZ2V0SW1hZ2VEYXRhKDAsMCxjdHguY2FudmFzLndpZHRoLGN0eC5jYW52YXMuaGVpZ2h0KVxuICAgIHN1YmltYWdlID0gWzldXG4gICAgIyBpdGVyYXRlIG92ZXIgaW1hZ2UgZGF0YVxuICAgIHdpZHRoID0gaW1hZ2Uud2lkdGhcbiAgICBoZWlnaHQgPSBpbWFnZS5oZWlnaHRcbiAgICBuZXdfaW1hZ2UgPSBjdHguY3JlYXRlSW1hZ2VEYXRhKHdpZHRoLCBoZWlnaHQpXG4gICAgZm9yIGkgaW4gWzAuLih3aWR0aCAqIGhlaWdodCAtIDEpXVxuICAgICAgIyBpdGVyYXRlIG92ZXIgc3F1YXJlIG9mIDkgcGl4ZWxzXG4gICAgICBmb3IgaiBpbiBbLTEuLjFdXG4gICAgICAgIGZvciBrIGluIFstMS4uMV1cbiAgICAgICAgICBpbmRleCA9IDQgKiAoaSArIChqICogd2lkdGgpICsgaylcbiAgICAgICAgICByID0gaW1hZ2UuZGF0YVtpbmRleCAgICBdXG4gICAgICAgICAgZyA9IGltYWdlLmRhdGFbaW5kZXggKyAxXVxuICAgICAgICAgIGIgPSBpbWFnZS5kYXRhW2luZGV4ICsgMl1cbiAgICAgICAgICBhID0gaW1hZ2UuZGF0YVtpbmRleCArIDNdXG4gICAgICAgICAgc3ViaW1hZ2VbKGogKyAxKSAqIDMgKyAoayArIDEpXSA9IEBsdW1pbmFuY2UociwgZywgYiwgYSlcbiAgICAgIHZhbHVlID0gMS41ICogQHNvYmVsX3NpbmdsZShzdWJpbWFnZSlcbiAgICAgICN2YWx1ZSA9IDEuNSAqIEBmYXN0X3NvYmVsKHN1YmltYWdlKVxuICAgICAgI2NvbnNvbGUubG9nKHZhbHVlKVxuICAgICAgaWYgdmFsdWUgPCB0aHJlc2hcbiAgICAgICAgdmFsdWUgPSAwXG4gICAgICBuZXdfaW1hZ2UuZGF0YVtpbmRleCAgICBdID0gdmFsdWVcbiAgICAgIG5ld19pbWFnZS5kYXRhW2luZGV4ICsgMV0gPSB2YWx1ZVxuICAgICAgbmV3X2ltYWdlLmRhdGFbaW5kZXggKyAyXSA9IHZhbHVlXG4gICAgICBuZXdfaW1hZ2UuZGF0YVtpbmRleCArIDNdID0gMjU1XG4gICAgI2NvbnNvbGUubG9nKG5ld19pbWFnZS5kYXRhKVxuICAgIGN0eC5wdXRJbWFnZURhdGEobmV3X2ltYWdlLDAsMClcblxuICBsdW1pbmFuY2U6IChyLCBnLCBiLCBhKSAtPlxuICAgIHJldHVybiAoMC4yMTI2ICogciArIDAuNzE1MiAqIGcgKyAwLjA3MjIgKiBiKVxuXG4gIGNocm9tYV9rZXk6IChjdHgsIHIsIGcsIGIpIC0+XG4gICAgaW1hZ2UgPSBjdHguZ2V0SW1hZ2VEYXRhKDAsMCxjdHguY2FudmFzLndpZHRoLGN0eC5jYW52YXMuaGVpZ2h0KVxuICAgIGxlbiA9IGltYWdlLmRhdGEubGVuZ3RoIC8gNFxuICAgIGZvciBpIGluIFswLi4obGVuIC0gMSldXG4gICAgICByZWQgPSBpbWFnZS5kYXRhWzQgKiBpICAgXVxuICAgICAgZ3JlZW4gPSBpbWFnZS5kYXRhWzQgKiBpICsgMV1cbiAgICAgIGJsdWUgPSBpbWFnZS5kYXRhWzQgKiBpICsgMl1cbiAgICAgIGEgPSBpbWFnZS5kYXRhWzQgKiBpICsgM11cbiAgICAgIGlmIChyZWQgPCByKSBhbmQgKGdyZWVuIDwgZykgYW5kIChibHVlIDwgYilcbiAgICAgICAgaW1hZ2UuZGF0YVs0ICogaSArIDNdID0gMFxuICAgIGN0eC5wdXRJbWFnZURhdGEoaW1hZ2UsMCwwKVxuXG5cbm1vZHVsZS5leHBvcnRzID0gSW1hZ2VFZGl0b3IiLCIjdXRpbGl0eSBzdHVmZlxuY2xhc3MgVXRpbFxuXG4gICMgYSBhbmQgYiBhcmUgbWF0cmljZXNcbiAgIyBhcyBhcnJheXMgb2YgbGVuZ3RoIDk6XG4gICMgWyBhIGIgY1xuICAjICAgZCBlIGZcbiAgIyAgIGcgaCBpIF1cbiAgY29udm9sdmU6IChhLCBiKSAtPlxuICAgIG91dHB1dCA9IFs5XVxuICAgIGZvciBpIGluIFswLi44XVxuICAgICAgb3V0cHV0W2ldID0gYVtpXSAqIGJbaV1cbiAgICByZXR1cm4gb3V0cHV0XG5cbiAgIyBhIGFuZCBiIGFyZSBtYXRyaWNlc1xuICAjIGFzIGFycmF5cyBvZiBsZW5ndGggOTpcbiAgIyBbIGEgYiBjXG4gICMgICBkIGUgZlxuICAjICAgZyBoIGkgXSAgXG4gIG1hdHJpeF9zdW06IChhLCBiKSAtPlxuICAgIG91dHB1dCA9IFs5XVxuICAgIGZvciBpIGluIFswLi44XVxuICAgICAgb3V0cHV0W2ldID0gYVtpXSArIGJbaV1cbiAgICByZXR1cm4gb3V0cHV0XG5cbiAgIyByZXR1cm5zIGF2ZXJhZ2UgdmFsdWUgb2YgbWF0cml4XG4gIG1hdHJpeF9tYWduaXR1ZGU6IChtYXRyaXgpIC0+XG4gICAgb3V0cHV0ID0gMFxuICAgIGZvciBpIGluIFswLi44XVxuICAgICAgb3V0cHV0ID0gb3V0cHV0ICsgbWF0cml4W2ldXG4gICAgcmV0dXJuIG91dHB1dFxuXG5tb2R1bGUuZXhwb3J0cyA9IFV0aWwiXX0=
